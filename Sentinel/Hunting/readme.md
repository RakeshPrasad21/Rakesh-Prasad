
# Sentinel-ThreatHunting

This threat hunting report outlines the findings and insights gathered during a mock threat hunting session conducted weekly. The objective of this session was to simulate and assess the effectiveness of our threat detection and response capabilities. The report provides an overview of the activities performed, key hypotheses tested, technical details, and relevant MITRE ATT&CK framework mappings.

In response to the evolving threat landscape, organizations must continually evaluate and enhance their cybersecurity posture. The mock threat hunting session served as a proactive exercise to identify potential security gaps, test detection mechanisms, and refine incident response processes. By mimicking real-world scenarios, the goal was to validate the organization's readiness to detect and respond to advanced threats.

1. [Account MFA Modifications](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AccountMFAModifications.yaml)
2. [Detect Network Beaconing](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Detect%20Network%20%20Beaconing.yml)
3. [Executable File attachment received](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Executable%20File%20attachment%20recieved.yml)
4. [Disabled Account Sign-in Attempts by Account Name](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/DisabledAccountSigninAttempts.yaml)
5. [New Admin account activity seen which was not seen historically](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/new_adminaccountactivity.yaml)
6. [Office Mail Forwarding](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/OfficeMailForwarding_hunting.yaml)
7. [Change Conditional Access Policy](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/ChangeConditionalAccessPolicy.yml)
8. [Cloud Discovery Performed by User at Risk](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/CloudDiscoveryByUserAtRisk.md)
9. [Multiple Accounts Locked](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/MultipleAccountsLocked.md)
10. [Failed attempt to access Azure Porta](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/UnauthUser_AzurePortal.yaml)
11. [Mass Cloud resource deletions Time Series Anomaly](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Threat_Essentials_TimeSeriesAnomaly_Mass_Cloud_Resource_Deletions.yaml)
12. [Privileged Accounts - Failed MFA](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AADPrivilegedAccountsFailedMFA.yaml)
13. [Anomalous Sign Ins Based on Time](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AnomolousSignInsBasedonTime.yaml)
14. [Browsing activity from server systems](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/BrowsingActivityFromServerSystems.yml)
15. [DNS requests to suspicious TLDs](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/DNS-RequestsToSuspiciousTLDs.yml)
16. [Spamhaus 10 Most Abused TLDs](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Spamhaus10MostAbusedTLDs.yml)
17. [Failed Login Attempt by Expired account](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/LogonwithExpiredAccount.yaml)
18. [Recently created Azure AD service principals created by new user accounts](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AADNewSPByNewUser.yaml)
19. [Multiple Sensitive Group Additions From Commandline](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/MultipleSentitiveGroupAdditions.md)
20. [Sign-ins originating from an unknown network (not in Named Location), that don't require MFA](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Sign-ins%20originating%20from%20an%20unknown%20network%20(not%20in%20Named%20Location)%2C%20that%20don't%20require%20MFA%20-%20AADMFABypass.yaml)
21. [Legacy authentication in Azure AD](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AADLegacyAuth.yaml)
22. [Changes in Azure AD Authentication Methods configuration](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AADAuthMethodsChange.yaml)
23. [New Azure AD users added to Azure AD roles](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AADNewUserWithAADRole.yaml)
24. [Newly registered devices in Azure AD](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AADNewDevices.yaml)
25. [DNS lookups for commonly abused TLDs](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/DNS_CommonlyAbusedTLDs.yaml)
26. [Check critical ports opened to the entire internet](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/CriticalPortsOpened.yaml)
27. [Boolean Blind SQL Injection](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/HuntingQuery-BooleanBlindSQLi.yaml)
28. [Azure VM Run Command executed from Azure IP address](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AzureRunCommandFromAzureIP.yaml)
29. [Palo Alto - high-risk ports](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/PaloAlto-HighRiskPorts.yaml)
30. [Suspicious SQL Stored Procedures](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/SuspiciousStoredProcedures.yaml)
31. [Time Based SQL Query Size Anomaly](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/TimeBasedQuerySizeAnomaly.yaml)
32. [Network Connection to New External LDAP Server](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/NetworkConnectionToNewExternalLDAPServer.yaml)
33. [Creation of an anomalous number of resources](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Creating_Anomalous_Number_Of_Resources.yaml)
34. [Authentication of user accounts from unusual large number of locations]()
35. [Detect Potential DLL Hijacking Cases]()
36. [Azure Storage Mass File Deletion](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AzureStorageMassDeletion.yaml)
37. [Azure Storage File Create and Delete](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/AzureStorageFileCreatedQuicklyDeleted.yaml)
38. [Lateral Movement Users on Windows security Event](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/Lateral%20Movement%20Users%20on%20Windows%20security%20Event.txt)
39. [Storage Alert Correlation with CommonSecurityLogs and StorageLogs](https://github.com/Mannai-Microsoft-Solutions/Sentinel-ThreatHunting/blob/main/ThreatHunting-UseCase/StorageAlertCorrelationwithCommonSecurityLogsandStorageLogs.yaml)
